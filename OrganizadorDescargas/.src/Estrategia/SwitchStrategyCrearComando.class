' Gambas class file

Private listaEstrategia As New InterfaceCrearComando[]

Public Sub _new()
  ''En el constructor indico que estrategia de construcción de comandos estan diponibles... 
  ''------------------------------------------
  ''NOTE: Listado de Estrategias disponibles:
  ''------------------------------------------
  ''NOTE: Si hubieran mas estrategias se añadirian continuacion
  '--- poner aqui nuevas estrategias... Dim XXXXXtmp as new EstrategiaXXXXX

  Dim estrategiaCopiartmp As New EstrategiaCopiar
  Dim estrategiaMovertmp As New EstrategiaMover
  Dim estrategiaBorrartmp As New EstrategiaBorrar
  
  '.---- añadir la estrategias a la lista de estrategias disponibles  estrategiaXXXXtmp.nombre=("XXXX")
  estrategiaBorrartmp.nombre = ("Borrar") 'indico tambien el nombre del comando, que nos servirá en el método ListaComando()
  estrategiaMovertmp.nombre = ("Mover")  'indico tambien el nombre del comando, que nos servirá en el método ListaComando()
  estrategiaCopiartmp.nombre = ("Copiar")  'indico tambien el nombre del comando, que nos servirá en el método ListaComando()
  
  'añado las distitas estrategias...add(XXXXXtmp)
  add(estrategiaCopiartmp)
  add(EstrategiaMovertmp)
  add(EstrategiaBorrartmp)
  '... 
  
End

Public Function listaComando() As String[]
  'Este comando devuelve automaticamente la lista de comandos que hay disponibles, por ejemplo es usado para rellenar el combobox del formulario

  Dim est As InterfaceCrearComando
  Dim ComandosReconocidos As New String[]
  
  For Each est In listaEstrategia
    ComandosReconocidos.Add(est.nombre)
  Next
  Return ComandosReconocidos
  
End

Public Sub operar(orden As String, datos As String) As Comando
  
  Dim iCrearcomando As New InterfaceCrearComando
  
  For Each iCrearcomando In listaEstrategia
    
    If iCrearcomando.guard(orden) Then 
      Return iCrearcomando.crearComando(datos)
    Endif
    
  Next
  'si llega aqui es que no ha encontrado el comando
  Message.Info(("Error: Comando desconocido") & " (" & orden & ")")
  Return Null
  
End

Public Sub add(estrategia As InterfaceCrearComando)
  
  listaEstrategia.Add(estrategia)
  
End
